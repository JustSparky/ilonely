{% extends "pages/base.html" %}
{% load leaflet_tags %}

{% block extrahead %}
    {% leaflet_js %}
    {% leaflet_css %}
    <script type="text/javascript" src="static/js/datepair.js"></script>
    <script type="text/javascript" src="static/js/jquery.datepair.js"></script>
    <script>
        // initialize input widgets first
        $('#eventDatePicker #eventTime').timepicker({
            'showDuration': true,
            'timeFormat': 'g:ia'
        });

        $('#eventDatePicker .eventDate').datepicker({
            'format': 'yyyy-m-d',
            'autoclose': true
        });

        // initialize datepair
        $('#eventDatePicker').datepair();
    </script>
{% endblock %}
{% block content %}
    
    <div class="container-fluid" style="margin-top:20px;">
        <div class="row">
            <div class="col-3" style="background:linear-gradient(150deg, #e7e7e7 42%, #ffffff 25%)">
                <button type="button" class="btn btn-primary" style="width:100%" data-toggle="modal" data-target="#addEventModal">
                    + Add Event
                </button>          
                <form action="{% url 'events' %}" method="post"> {% csrf_token %}
                <ul class="list-group list-group-flush">
                {% for event, distance in events %}
                    <li style="border: none; " class="list-group-item"> 
                        <button style="cursor:pointer;width:400px;padding-top:5px;padding-bottom:5px;padding-left:20px;border:none;
                             background-color:#f2f2f2;box-shadow: 3px 3px 3px #cecece;" type="submit" name="viewEvent" value="{{event.id}}">
                            <p style="padding-left:15px;float:left;margin-top:10px;">{{event.name}}</p>
                            <p style="padding-left:15px;float:left;margin-top:10px;">{{event.date}}</p>
                            <span style="float:right; padding-right:5px;">&#8250;</span>
                            <small style="text-align:right;align-self:center;float:right" class="distances text-muted ">{{ distance }}mi</small>
                        </button>
                    </li>
                {% endfor %}
                </ul>
                </form>
            </div>
            <div class="col-9">
                {% include "pages/activeEvent.html" activeEvent %}
            </div>
        </div>
    </div>
    
    <div class="modal fade" id="addEventModal" tabindex="-1" role="dialog" aria-labelledby="modalTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalTitle">Add Event</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <form id="newEvent" action="{% url 'events' %}" method="post"> {% csrf_token %}
                    <div class="modal-body">
                        <div class="form-group shadow-textarea">
                            <input class="form-control" type="text" name="eventName" />
                            <div id="eventDatePicker">
                            Date: <input class="form-control" type="text" id="eventDate" name="eventDate" /> 
                            Time: <input class="form-control" type="text" id="eventTime" name="eventTime" />
                            </div>
                            location input / lat / long
                            Category: <select name="eventCategories" class="form-control">
                                <option value="outdoors">Outdoors</option>
                                <option value="exercise">Exercise</option>
                                <option value="cooking">Food and Drink</option>
                                <option value="social">Social</option>
                                <option value="filmAndPhoto">Film and Photography</option>
                                <option value="learning">Learning</option>
                                <option value="technology">Technology</option>
                            </select>
                            Description: <textarea id="eventDescription" name="eventDescription" style="width:100%; border-radius:.25rem; border:1px solid #ced4da; 
                                        box-shadow:0px 2px 5px 0px rgba(0,0,0,0.16), 0px 2px 10px 0px rgba(0,0,0,0.12) !important;" 
                                        placeholder="Enter event description here..." maxlength="300" rows="4" ></textarea>                       
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary">Post</button>                   
                    </div>
                </form>
            </div>
        </div>
    </div> 
    
    <p><a href={% url 'user_home' %}>Go Back</a></p>
{% endblock %}