{% extends "pages/base.html" %}

{% block content %}

<style>
.productButton {
    display: inline-block;
    height: 240px;
    width: 190px;
    background-color: lightgray;
    border-style: solid;
    border-color: lightgray;
    text-decoration: none;
    border-radius: 5px;
}
.productButton:hover {
    color: pink;
}

.productUpper {
     width:100%; 
     height: 70%; 
     overflow:hidden; 
     border-radius:3px 3px 0 0;
     background-color:black;
}

.productLower {
     width:100%; 
     height: 30%; 
     background-color:white; 
     color:black;
     border-radius: 0 0 3px 3px;
}

.priceTag {
    z-index:10; 
    position:absolute; 
    background-color:rgba(0, 0, 0, 0.75);
    color:white;
    border-radius:5px;
}
</style>
<div class="mx-auto">
    <h2 style="text-align:center;">Marketplace in {{request.user.profile.location}}</h2>
</div>

<div class="container">
    <div class="row">
        <div class=" col-3 p-3" style="text-align:center;">
            <button type="button" class="btn btn-block btn-primary m-1" data-toggle="modal" data-target="#uploadProduct">
                Sell Something
            </button>
            <h5>TODO: Implement Filters</h5>
            <div style="text-align:left;">
                Sort by:
                <ul>
                    <li>Date</li>
                    <li>Price: Low to High</li>
                    <li>Price: High to Low</li>
                </ul>
                Price:
                <ul>
                    <li>Price Min</li>
                    <li>Price Max</li>
                </ul>
                Posted Within:
                <ul>
                    <li>Last 24 hours</li>
                    <li>Last 7 days</li>
                    <li>Last 30 days</li>
                </ul>
            </div>
        </div>
        <div style="text-align:center" class="col border-left p-3">
            <div style="text-align:left;">
                {% for product in products %}
                    <a style="text-decoration: none;" href="{% url 'listing' product.id %}" class="productButton m-1">
                        <div class="productUpper">
                            <div class="p-1 m-1 priceTag">
                                {% if product.price is not 0 %}
                                    <b>${{ product.price }}</b>
                                {% else %}
                                    <b>FREE</b>
                                {% endif %}
                            </div>
                            {% if product.photo %}
                                <img style="width:100%" src="{{ product.photo.url }}" />
                            {% endif %}
                        </div>
                        <div class="p-2 productLower">
                            <p style="text-overflow: ellipsis; overflow:hidden; white-space: nowrap; margin-bottom:5px;">
                                <b>{{ product.name }}</b>
                            </p>
                            <p class="text-muted" style="font-size:10pt;">
                                {{ product.location }}
                            </p>
                        </div>
                    </a>
                {% endfor %}
            </div>
        </div>
    </div>

    <div class="modal fade" id="uploadProduct" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="productTitle">
                            What are you selling?
                        </h5>
                        <button type="button" class="close" data-dismiss="modal">
                            <span>&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group row">
                            <label class="col-sm-3">Name</label>
                            <div class="col-sm-9">
                                {{ form.name }}
                            </div>
                        </div>

                        <div class="form-group row">
                            <label class="col-sm-3">Photo</label>
                            <div class="col-sm-9">
                                {{ form.photo }}
                            </div>
                        </div>

                        <div class="form-group row">
                            <label class="col-sm-3">Description</label>
                            <div class="col-sm-9">
                                {{ form.description }}
                            </div>
                        </div>

                        <div class="form-group row">
                            <label class="col-sm-3">Price</label>
                            <div class="col-sm-9">
                                {{ form.price }}
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary">Submit</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>



{% endblock %}